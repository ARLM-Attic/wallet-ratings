Bitcoin Wallet Privacy Rating - Spring 2015
============================================

<dl>
    <dt>Rank</dt>
    <dd></dd>
    <dt>Name</dt>
    <dd>Blockchain</dd>
    <dt>Type</dt>
    <dd>Wallet</dd>
    <dt>Tested Version</dt>
    <dd>March 2015 production website</dd>
    <dt>Supported Platforms</dt>
    <dd>Android, iOS, Web</dd>
    <dt>Score</dt>
    <dd>
        <dl>
          <dt>Overall</dt>
          <dd>7</dd>
          <dt>Quality</dt>
          <dd>7</dd>
          <dt>Usability</dt>
          <dd>7</dd>
          <dt>Feedback</dt>
          <dd>9</dd>
        </dl>
    </dd>
</dl>

##Description##

Blockchain.info helped early adoption of Bitcoin by providing one of the first web wallets to new users. Blockchain.info also served as early advocates for users to maintain control over their own private keys, decreasing their security and privacy risk against third parties. The service maintains a large share of the Bitcoin user base, with nearly 3.4 million wallet accounts currently in existence. The service has sometimes lead in protecting user privacy, the chief example of which was the early implementation of a CoinJoin-based, peer-to-peer mixing service called SharedCoin. SharedCoin can be optionally used when sending funds from the Blockchain.info web wallet.

However, in recent times, Blockchain.info’s web wallet has fallen behind competitors. Users must perform additional actions outside of the normal sending and receiving workflows to avoid simple privacy pitfalls such as address reuse. Due to the lack of an HD architecture, fixing these blockchain privacy issues is a challenge, as is simplifying the steps required for users to backup wallets completely. While it is trivial for users to connect to the web wallet via Tor using an operating system such as Tails, all balance information is obtained from the same centralized server that transactions are sent to, maintained by Blockchain.info. This can potentially protect the privacy of users of their wallet or wallet API from the larger Bitcoin network, but requires users to trust Blockchain.info with this privacy-sensitive data. The centralized server model is inherently more limited than a Bitcoin light client model that connects to other peers in the Bitcoin network.

##Questionnaire Response##

Blockchain's responses are listed in bold.

**Thanks for the invitation to provide clarification to the OBPP concerning our wallet. User privacy is very important to Blockchain. Our philosophy is to provide a spectrum of privacy to users to choose from based on their preferences. On one end of the spectrum, users can create accounts without providing an email or phone number, connect to us through Tor, and send all transactions through SharedCoin.**

**On the other end of the spectrum, users can connect to us on the clearnet, register with an email address, and use their mobile phone to transact and authenticate with SMS. We look forward to your feedback about ways to enhance our wallet on web, iOS, and Android to accommodate our users on all parts of the spectrum.**

**At the end of the day, our goal is to provide software options to many types of bitcoin users.**

1: Please classify your application as one of the three categories:
  * Wallet: all of the private keys needed to create a blockchain transaction are under the exclusive control of the user
  * Pseudo-wallet: none of the private keys needed to create a blockchain transaction are under the exclusive control of the user
  * Hybrid wallet: some portion of the private keys needed to create a blockchain transaction are under the exclusive control of the user

**a) Blockchain.info is a wallet -- all private keys are generated by the user’s machine, and we do not store any decryptable version of the keys.**

2: Does your application provide any type of visual warning to the user when events which may reduce their privacy or safety occur, such as:
  * Receiving funds to an address which has previously received incoming transactions
  
**Not currently.**

  * Backups have been invalidated by new receiving or change address creation

**Not currently. Users can enable automatic wallet backups via email if they want the wallet to be automatically backed up each time a modification takes place, but this is disabled by default. A new version of the wallet will be released soon which will obviate the need for backups after initial setup.**

  * If the wallet supports mixing, a proposed mixing transaction is easily reversible

**The web version of our wallet includes the SharedCoin feature, which is based on the CoinJoin protocol. Though not a perfect CoinJoin implementation, this feature was made resistant to sudoku analysis in early 2015. Users are alerted to the limitations of SharedCoin before using the service here: https://sharedcoin.com/ There are no specific visual indications that vary during use of SharedCoin to indicate the degree of privacy afforded.**

  * An outgoing transaction sends funds to a previously-used address
  
**Not currently**

  * An outgoing transaction links inputs from multiple addresses

**Not currently. When a user performs a custom send, they have an opportunity to review the transaction before it is signed and broadcast to the network. If they click on “Advanced” in the review screen, the Blockchain.info wallet will list all of the inputs that will be included in the transaction, whether they have been selected manually by the user or automatically selected by the application to constitute the desired amount of funds. However, the user interface does not explicitly warn the user about the privacy consequences of merging inputs.**

  * Network connectivity to peers or dedicated balance servers is not routed through an anonymous channel

**Our wallet does not currently provide any warning to users concerning their connection to the website through an anonymous channel, such as Tor.**

  * An outgoing transaction links inputs from multiple accounts/identities

**Our current wallet does not support accounts or identities.**

3: Does your application’s backup process involve any activity which may be visible to an external network observer?

**We do not currently perform any automatic backups of wallets. Upon account creation, users are instructed to backup their mnemonic, which encodes their wallet identifier and password. No wallet backup requires automatically, aside from caching in the browser of the encrypted wallet payload. We provide a number of ways to manually backup wallets, some of which can be visible to an external network observer (see chart below):**

| Backup Option | Visible to external network observer? |
|-----------------|-----------------------------------------|
| Browser caching | No |
| Download | No, using JavaScript the wallet data is turned into a “blob” and the user is presented with a download dialogue for wallet.aes.json |
| Dropbox | Yes. Users will connect to DropBox to authenticate with the OAuth API. Wallet identifiers are not disclosed in URLs, and all communications with DropBox are encrypted with SSL/TLS.|
| Google Drive | Yes. Users will connect to Google Drive to authenticate with the OAuth API. Wallet identifiers are not disclosed in URLs, and all communications with DropBox are encrypted with SSL/TLS |
| Email | Yes. Email is not encrypted. The email will be sent to the address that the user configures for their wallet account. |
| Paper | No, uses data: uri. |

**All forms of wallet backup are AES encrypted so that the user’s wallet identifier is not in plaintext in the backup file, and the user’s password is required to decrypt the backup file.**

4: Does your application take positive steps to make change outputs indistinguishable from spending outputs, such as:
  * Randomizing the number of change outputs

**No, our wallet currently only generates a single change output**

  * Randomizing the position of the change output(s)

**When using Custom Send to a single recipient and a single change address, the change address is always listed second in the transaction and not randomized. When using SharedCoin, all inputs and ouputs are randomly shuffled by the SharedCoin server, and so change outputs are necessarily randomized:**

**https://github.com/blockchain/Sharedcoin/blob/master/website/src/piuk/website/SharedCoin.java#L1979**

  * Selecting sufficient input value such that the change output(s) closely resemble the size of the desired spend

**No, our wallet does not currently try to match change outputs with the size of a desired spend.**

  * Intentionally creating “decoy” change outputs that have a low number of significant digits

**No, our wallet does not create decoy change outputs.**

5: If your application includes mixing functionality:

  * Is it possible for a malicious participant in the mix to steal funds?

**No. All private keys are held by the users in browser and cannot be stolen by the server. Participants are unable to steal each other’s mixing funds due to the properties of the CoinJoin protocol that SharedCoin is based on.**

  * Is it possible for any participant in the mix to retain information which correlates outputs to their corresponding inputs?
  
**Mixing peers only retain information about their own inputs and outputs. The SharedCoin server has visibility over all inputs and outputs, and which peers they belong to. Future versions of SharedCoin may be cryptographically “blinded” to this information.**

6: If your application obtains balance information from dedicated servers:

**No. Some Airbitz and some non-airbitz servers. All peer-to-peer open source servers**

  * Is it possible to operate the dedicated servers in a manner which correlates:
    * A user’s receiving or change address to another receiving or change address in the same wallet

**All transactions are pushed through a single server. The server would be able to identify recurring addresses between several transactions. We avoid logging such data as much as possible.**

    * Any of the above with a public IP address

**Our web server is required by design to see the user’s IP address. We avoid logging such data as much as possible, except for authorization purposes (See response to software fingerprinting below). We maintain an .onion address for Tor users who wish to keep their accounts dissociated from their public IP addresses.**

    * Any of the above with a registered account 

**Lookups of the balance information for specific addresses come through the same server as the one used for logging into accounts. We avoid logging such data as much as possible.**

    * Any of the above with a persistent software or hardware fingerprint

**Our web wallet server is capable of identifying browser fingerprints unless users take steps to randomize or standardize their fingerprint. We avoid logging such data as much as possible, though some fingerprint information is collected in order to prompt users for email authorization when they attempt to download their encrypted wallet file (login) on a new machine.**

7: If your application obtains balance information by uploading a filter to network peers:
  * Are filters ever updated in a manner that allows the peer to correlate the old and new filter with the same connection?

**Our wallet does not connect directly to network peers.**

8: Does your application take positive steps to route outgoing transactions through different path to the network than the path via which it receives balance and incoming transaction information?

**No, all data is sent through the same server.**

9: If your application supports multiple accounts/identities:
  * Does your application take positive steps to route balance, incoming and outgoing transaction information through different network paths for each account/identity?

**Our wallet does not currently support accounts or identities.**

##Question Scores##

<dl>
    <dt>I A 1 a): Number of clicks required to deviate from the default receiving functionality and generate a new receiving address for an existing wallet.</dt>
    <dd>5.6</dd>
    <dt>I A 2 a): Receiving addresses are hidden from the default view once they have been used?</dt>
    <dd>0</dd>
    <dt>I A 2 b): Preemptively indicates a loss of privacy when user elects to receive funds at a previously-used addresses?</dt>
    <dd>0</dd>
    <dt>I B 1 a): Number of clicks to backup a newly-generated receiving address from an existing wallet (worst case), from the default window/authenticated home page.</dt>
    <dd>0.69</dd>
    <dt>I B 2 a): Does the backup process leak information about wallet addresses (e.g. each time a new change address is created on-demand, an email backup is triggered immediately)?</dt>
    <dd>1.39</dd>
    <dt>I B 3 a): Indicates a reduction in wallet safety when receiving address backups are stale, or uses eternal backups?</dt>
    <dd>0</dd>
    <dt>II A 1 a): Number of clicks required to deviate from the default change functionality and receive change at a newly generated address</dt>
    <dd>2.36</dd>
    <dt>II A 2 a): The position of the change output(s) in the transaction is random?</dt>
    <dd>0</dd>
    <dt>II A 2 b): One or more change outputs are created which are close to the value of the desired spend?</dt>
    <dd>0</dd>
    <dt>II A 2 c): Some change output values are intentionally set to “round numbers” (a.k.a low number of significant digits)?</dt>
    <dd>0</dd>
    <dt>II A 3 a): Change addresses are hidden from the normal receiving workflow by default to discourage using them as receiving addresses?</dt>
    <dd>0</dd>
    <dt>II A 3 b): Preemptively indicates a loss of privacy when user elects to reuse change addresses as receiving addresses?</dt>
    <dd>0</dd>
    <dt>II B 1 a): Number of clicks to backup a newly-generated change address from an existing wallet (worst case), apart from the sending workflow</dt>
    <dd>0.55</dd>
    <dt>II B 2 a): Backups can occur offline, or are encrypted client-side with data that only the user controls e.g. password?</dt>
    <dd>1.39</dd>
    <dt>II B 3 a): Indicates a reduction in wallet safety when change address backups are stale, or uses eternal backups?</dt>
    <dd>0</dd>
    <dt>III A 1 a): Number of clicks required by user for inputs/outputs to be mixed with one or more other users</dt>
    <dd>1.19</dd>
    <dt>III A 2 a): Average number of other users whose funds are mixed with yours when sending through a mixing process</dt>
    <dd>0.65</dd>
    <dt>III A 2 b): Mixing is secure against correlation attacks by the facilitator?</dt>
    <dd>0</dd>
    <dt>III A 2 c): Mixing is secure against theft of funds?</dt>
    <dd>0.79</dd>
    <dt>III A 3 a): Warns the user when a proposed mix is easy to reverse?</dt>
    <dd>0</dd>
    <dt>III B 1 a): Warns user when sending to an address that the user has sent to before?</dt>
    <dd>0</dd>
    <dt>III C 1 a): When an outgoing transaction must merge inputs, and when mixing is not being used, is the transaction constructed in a way that plausibly resembles a mixing transaction?</dt>
    <dd>0</dd>
    <dt>III C 2 a): Outside of a mixing transaction, preemptively indicates a loss of privacy when merging inputs from different addresses in the same transaction?</dt>
    <dd>0</dd>
    <dt>III D 1 a): Avoids creating transactions which contain inputs from different identity containers, except optionally if the user has intentionally overridden this behavior?</dt>
    <dd>0</dd>
    <dt>IV A 1 a): Number of clicks required by user to generate a ECDH receiving address, from the default window/authenticated home page.</dt>
    <dd>0</dd>
    <dt>IV B a a): Wallet avoids leaking information about recipients via an external identity lookup?</dt>
    <dd>5.56</dd>
    <dt>V A 1 a): Number of clicks required by user to connect to the source of balance information without leaking their identity over the network</dt>
    <dd>0</dd>
    <dt>V A 2 a): Is balance information obtained in a manner which avoids leaking the addresses in a wallet to network peers?</dt>
    <dd>0</dd>
    <dt>V A 3 a): Client provides a visual indication if the balance information is not being obtained through an anonymizing network, including IP address information?</dt>
    <dd>0</dd>
    <dt>V B 1 a): Number of clicks required by user to route outgoing transactions through an anonymizing network</dt>
    <dd>0</dd>
    <dt>V B 2 a): Are outgoing transactions routed through a different entry point into the network than the source of balance information?</dt>
    <dd>0</dd>
    <dt>V B 3 a): Client provides a visual indication if outgoing transactions are not being routed through an anonymizing network, including IP address information?</dt>
    <dd>0</dd>
    <dt>V C 1 a): Number of clicks to create a new identity container</dt>
    <dd>0</dd>
    <dt>V C 1 b): Number of clicks to assign an imported address to an identity container</dt>
    <dd>0</dd>
    <dt>V C 2 a): Avoids including addresses from multiple identity containers in the same address filter?</dt>
    <dd>0</dd>
    <dt>V C 2 b): Avoids broadcasting outgoing transactions from different identity containers via the same network access path?</dt>
    <dd>0</dd>
    <dt>V C 3 a): Visually indicates to user when inputs from different accounts/pockets are merged before the transaction is broadcast, or prohibits this operation entirely.</dt>
    <dd>0</dd>
    <dt>V D 1 a): Compatible with latest version of Tails?</dt>
    <dd>2.08</dd>
</dl>
